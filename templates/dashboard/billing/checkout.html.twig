{% extends 'dashboard/base.html.twig' %}

{% block title %}Checkout - Pushify{% endblock %}
{% block page_title %}Complete Your Purchase{% endblock %}
{% block page_subtitle %}Subscribe to create and manage your servers{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
	<div class="grid md:grid-cols-2 gap-8">
		<!-- Left: Payment Form -->
		<div>
			<div class="bg-gray-800/50 border border-gray-700/50 rounded-xl p-6">
				<h3 class="text-xl font-semibold text-white mb-6">Payment Details</h3>

				<div data-controller="react" data-react-component-value="billing/PaymentForm" data-react-props-value="{{ {
					serverType: server_type,
					amount: pricing.final_price_eur,
					csrfToken: csrf_token('checkout')
				}|json_encode|e('html_attr') }}"></div>
			</div>
		</div>

		<!-- Right: Order Summary -->
		<div>
			<div class="bg-gray-800/50 border border-gray-700/50 rounded-xl p-6 sticky top-6">
				<h3 class="text-xl font-semibold text-white mb-6">Order Summary</h3>

				<div class="space-y-4">
					<!-- Server Details -->
					<div class="p-4 bg-gray-900/50 rounded-lg">
						<div class="flex items-center justify-between mb-3">
							<span class="text-sm font-medium text-gray-400">Server Type</span>
							<span class="text-sm font-bold text-white">{{ server_type|upper }}</span>
						</div>

						<div class="space-y-2 text-sm text-gray-400">
							{% if server_type == 'cx11' %}
								<div class="flex items-center gap-2">
									<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path></svg>
									<span>2 vCPU</span>
								</div>
								<div class="flex items-center gap-2">
									<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg>
									<span>4 GB RAM</span>
								</div>
								<div class="flex items-center gap-2">
									<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path></svg>
									<span>40 GB SSD</span>
								</div>
							{% elseif server_type == 'cx22' %}
								<div class="flex items-center gap-2">
									<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path></svg>
									<span>2 vCPU</span>
								</div>
								<div class="flex items-center gap-2">
									<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg>
									<span>8 GB RAM</span>
								</div>
								<div class="flex items-center gap-2">
									<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path></svg>
									<span>160 GB SSD</span>
								</div>
							{% endif %}
						</div>
					</div>

					<!-- Pricing Breakdown -->
					<div class="space-y-3 py-4 border-t border-b border-gray-700/50">
						<div class="flex items-center justify-between text-sm">
							<span class="text-gray-400">Server Cost (Hetzner)</span>
							<span class="text-gray-300">â‚¬{{ pricing.cost_eur }}</span>
						</div>
						<div class="flex items-center justify-between text-sm">
							<span class="text-gray-400">Platform Fee ({{ pricing.markup_percentage }}%)</span>
							<span class="text-gray-300">â‚¬{{ (pricing.final_price_eur - pricing.cost_eur)|number_format(2, '.', ',') }}</span>
						</div>
						<div class="flex items-center justify-between text-lg font-bold">
							<span class="text-white">Total (Monthly)</span>
							<span class="text-primary">â‚¬{{ pricing.final_price_eur }}</span>
						</div>
						<div class="text-xs text-gray-500 text-center">
							â‰ˆ ${{ pricing.final_price_usd }} USD
						</div>
					</div>

					<!-- Features -->
					<div class="space-y-2">
						<h4 class="text-sm font-semibold text-white mb-3">What's Included</h4>
						<div class="space-y-2 text-sm text-gray-400">
							<div class="flex items-center gap-2">
								<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
								<span>Unlimited projects</span>
							</div>
							<div class="flex items-center gap-2">
								<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
								<span>Auto SSL certificates</span>
							</div>
							<div class="flex items-center gap-2">
								<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
								<span>Docker & Git support</span>
							</div>
							<div class="flex items-center gap-2">
								<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
								<span>Database backups</span>
							</div>
							<div class="flex items-center gap-2">
								<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
								<span>24/7 monitoring</span>
							</div>
							<div class="flex items-center gap-2">
								<svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
								<span>Cancel anytime</span>
							</div>
						</div>
					</div>

					<!-- Money Back -->
					<div class="p-3 bg-green-500/10 border border-green-500/30 rounded-lg">
						<p class="text-xs text-green-400 text-center">
							ðŸ’° 7-day money-back guarantee. No questions asked.
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}
