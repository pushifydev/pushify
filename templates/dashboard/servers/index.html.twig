{% extends 'dashboard/base.html.twig' %}

{% block title %}Servers - Pushify{% endblock %}
{% block page_title %}Servers{% endblock %}
{% block page_subtitle %}Manage your deployment servers{% endblock %}

{% block topbar_actions %}
<a href="{{ path('app_server_new') }}" class="px-4 py-2 bg-primary hover:bg-primary/90 text-white font-semibold rounded-lg transition-all inline-flex items-center gap-2">
	<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
		<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
	</svg>
	Add Server
</a>
{% endblock %}

{% block content %}
<div class="space-y-6">
	{# Subscription Warning Banner #}
	{% if not app.user.hasActiveSubscription() %}
	<div class="bg-gradient-to-r from-primary/20 via-purple-500/20 to-primary/20 border border-primary/50 rounded-xl p-6">
		<div class="flex items-start gap-4">
			<div class="w-12 h-12 bg-primary/20 rounded-xl flex items-center justify-center flex-shrink-0">
				<svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
				</svg>
			</div>
			<div class="flex-1">
				<h3 class="text-lg font-semibold text-white mb-2">Subscribe to Create Servers</h3>
				<p class="text-gray-300 mb-4">You need an active subscription to create and manage servers. Starting from â‚¬6.64/month with full features and support.</p>
				<div class="flex items-center gap-3">
					<a href="{{ path('app_billing_checkout_page', {server_type: 'cx22'}) }}" class="px-6 py-2.5 bg-primary hover:bg-primary/90 text-white font-semibold rounded-lg transition-all inline-flex items-center gap-2">
						<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
						</svg>
						Subscribe Now
					</a>
					<a href="{{ path('app_pricing') }}" class="px-6 py-2.5 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg transition-all">
						View Pricing
					</a>
				</div>
			</div>
		</div>
	</div>
	{% endif %}

	{% if servers is empty %}
	<div class="bg-gray-800/50 border border-gray-700/50 rounded-xl p-12 text-center">
		<div class="w-16 h-16 mx-auto mb-4 bg-gray-700/50 rounded-xl flex items-center justify-center">
			<svg class="w-8 h-8 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"></path>
			</svg>
		</div>
		<h3 class="text-lg font-semibold text-white mb-2">No servers yet</h3>
		<p class="text-gray-400 mb-6">Add a server to deploy your applications.</p>
		<a href="{{ path('app_server_new') }}" class="inline-flex items-center gap-2 px-6 py-3 bg-primary hover:bg-primary/90 text-white font-semibold rounded-lg">
			Add Your First Server
		</a>
	</div>
	{% else %}
	<div class="grid gap-4">
		{% for server in servers %}
		<a href="{{ path('app_server_show', {id: server.id}) }}" class="block bg-gray-800/50 border border-gray-700/50 rounded-xl p-6 hover:border-gray-600 transition-all group">
			<div class="flex items-center justify-between">
				<div class="flex items-center gap-4">
					<div class="w-12 h-12 rounded-xl flex items-center justify-center {{ server.statusBadgeClass }}">
						<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2"></path>
						</svg>
					</div>
					<div>
						<div class="flex items-center gap-3">
							<h3 class="font-semibold text-white group-hover:text-primary">{{ server.name }}</h3>
							<span class="px-2 py-0.5 text-xs rounded-full {{ server.statusBadgeClass }}">{{ server.status|capitalize }}</span>
							{% if server.provider != 'custom' %}
							<span class="px-2 py-0.5 text-xs rounded-full bg-blue-500/20 text-blue-400">{{ server.providerLabel }}</span>
							{% endif %}
						</div>
						<div class="flex items-center gap-4 mt-1 text-sm text-gray-400">
							<span class="font-mono">{{ server.ipAddress }}</span>
							{% if server.cpuCores %}{{ server.cpuCores }} CPU{% endif %}
							{% if server.memoryGb %}{{ server.memoryGb }}GB RAM{% endif %}
							{% if server.dockerInstalled %}<span class="text-green-400">Docker</span>{% endif %}
						</div>
					</div>
				</div>
				<svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
				</svg>
			</div>
		</a>
		{% endfor %}
	</div>
	{% endif %}
</div>
{% endblock %}
